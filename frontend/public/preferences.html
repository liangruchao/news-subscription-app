<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>偏好设置 - 新闻订阅系统</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/preferences.css">
</head>
<body>
    <div class="container">
        <!-- 头部 -->
        <header>
            <h1 data-i18n="nav.home">新闻订阅系统</h1>
            <nav class="nav-menu">
                <a href="index.html" data-i18n="nav.home">首页</a>
                <a href="profile.html" data-i18n="nav.profile">个人中心</a>
                <a href="messages.html" data-i18n="nav.messages">消息<span id="messageBadge" class="badge"></span></a>
                <a href="announcements.html" data-i18n="nav.announcements">公告</a>
                <a href="preferences.html" class="active" data-i18n="nav.preferences">设置</a>
                <a href="#" onclick="logout()" data-i18n="nav.logout">退出</a>
            </nav>
        </header>

        <!-- 主要内容 -->
        <main class="preferences-main">
            <h1 data-i18n="preferences.title">偏好设置</h1>

            <!-- 通知设置 -->
            <section class="preference-section">
                <h2 data-i18n="preferences.notificationSettings">🔔 通知设置</h2>
                <div class="preference-item">
                    <div class="preference-info">
                        <h3 data-i18n="preferences.newsNotification">新闻推送通知</h3>
                        <p data-i18n="preferences.newsNotificationDesc">当有新的新闻内容时接收通知</p>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="newsNotificationEnabled" onchange="savePreferences()">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="preference-item">
                    <div class="preference-info">
                        <h3 data-i18n="preferences.systemNotification">系统消息通知</h3>
                        <p data-i18n="preferences.systemNotificationDesc">接收系统消息和更新提醒</p>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="systemNotificationEnabled" onchange="savePreferences()">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="preference-item">
                    <div class="preference-info">
                        <h3 data-i18n="preferences.subscriptionNotification">订阅变动通知</h3>
                        <p data-i18n="preferences.subscriptionNotificationDesc">订阅状态发生变化时接收通知</p>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="subscriptionNotificationEnabled" onchange="savePreferences()">
                        <span class="slider"></span>
                    </label>
                </div>
            </section>

            <!-- 显示设置 -->
            <section class="preference-section">
                <h2 data-i18n="preferences.displaySettings">🎨 显示设置</h2>
                <div class="preference-item">
                    <div class="preference-info">
                        <h3 data-i18n="preferences.newsPageSize">新闻每页显示数量</h3>
                        <p data-i18n="preferences.newsPageSizeDesc">设置每次加载新闻时的显示数量</p>
                    </div>
                    <select id="newsPageSize" class="preference-select" onchange="savePreferences()">
                        <option value="10">10 条</option>
                        <option value="20">20 条</option>
                        <option value="30">30 条</option>
                        <option value="50">50 条</option>
                    </select>
                </div>
                <div class="preference-item">
                    <div class="preference-info">
                        <h3 data-i18n="preferences.compactMode">紧凑模式</h3>
                        <p data-i18n="preferences.compactModeDesc">使用更紧凑的界面布局</p>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="compactMode" onchange="savePreferences()">
                        <span class="slider"></span>
                    </label>
                </div>
            </section>

            <!-- 语言设置 -->
            <section class="preference-section">
                <h2 data-i18n="preferences.languageSettings">🌐 语言设置</h2>
                <div class="preference-item">
                    <div class="preference-info">
                        <h3 data-i18n="preferences.interfaceLanguage">界面语言</h3>
                        <p data-i18n="preferences.interfaceLanguageDesc">选择系统界面显示语言</p>
                    </div>
                    <select id="language" class="preference-select" onchange="handleLanguageChange()">
                        <option value="zh-CN">简体中文</option>
                        <option value="en-US">English</option>
                    </select>
                </div>
            </section>

            <!-- 隐私设置 -->
            <section class="preference-section">
                <h2 data-i18n="preferences.privacySettings">🔒 隐私设置</h2>
                <div class="preference-item">
                    <div class="preference-info">
                        <h3 data-i18n="preferences.publicProfile">公开个人资料</h3>
                        <p data-i18n="preferences.publicProfileDesc">允许其他用户查看您的基本信息</p>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="publicProfile" onchange="savePreferences()">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="preference-item">
                    <div class="preference-info">
                        <h3 data-i18n="preferences.showOnlineStatus">显示在线状态</h3>
                        <p data-i18n="preferences.showOnlineStatusDesc">显示您的最后登录时间</p>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="showOnlineStatus" onchange="savePreferences()">
                        <span class="slider"></span>
                    </label>
                </div>
            </section>

            <!-- 保存提示 -->
            <div id="saveMessage" class="save-message">
                <span class="save-icon">✓</span>
                <span class="save-text" data-i18n="preferences.saved">设置已保存</span>
            </div>
        </main>

        <!-- 页脚 -->
        <footer>
            <p>&copy; 2025 新闻订阅系统 | Powered by NewsAPI</p>
        </footer>
    </div>

    <script src="/js/api.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/i18n.js"></script>
    <script src="/js/preferences.js"></script>
    <script>
        // 页面加载时初始化
        window.onload = async function() {
            if (!await isLoggedIn()) {
                window.location.href = 'login.html';
                return;
            }
            await loadPreferences();
            updateMessageBadge();
        };
    </script>
</body>
</html>
