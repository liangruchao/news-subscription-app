<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¶ˆæ¯ä¸­å¿ƒ - æ–°é—»è®¢é˜…ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/messages.css">
</head>
<body>
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <header>
            <h1>æ–°é—»è®¢é˜…ç³»ç»Ÿ</h1>
            <nav class="nav-menu">
                <a href="index.html">é¦–é¡µ</a>
                <a href="profile.html">ä¸ªäººä¸­å¿ƒ</a>
                <a href="messages.html" class="active">æ¶ˆæ¯<span id="messageBadge" class="badge"></span></a>
                <a href="announcements.html">å…¬å‘Š</a>
                <a href="preferences.html">è®¾ç½®</a>
                <a href="#" onclick="logout()">é€€å‡º</a>
            </nav>
        </header>

        <!-- ä¸»è¦å†…å®¹ -->
        <main class="messages-main">
            <!-- æ¶ˆæ¯è¿‡æ»¤å™¨ -->
            <div class="messages-filter">
                <button class="filter-btn active" onclick="filterMessages('all')">å…¨éƒ¨æ¶ˆæ¯</button>
                <button class="filter-btn" onclick="filterMessages('unread')">æœªè¯»æ¶ˆæ¯</button>
                <button class="filter-btn" onclick="filterMessages('read')">å·²è¯»æ¶ˆæ¯</button>
                <div class="filter-actions">
                    <button class="btn btn-primary" onclick="markAllAsRead()">å…¨éƒ¨å·²è¯»</button>
                </div>
            </div>

            <!-- æ¶ˆæ¯åˆ—è¡¨ -->
            <div id="messagesList" class="messages-list">
                <!-- åŠ¨æ€åŠ è½½æ¶ˆæ¯ -->
            </div>

            <!-- ç©ºçŠ¶æ€ -->
            <div id="emptyState" class="empty-state" style="display: none;">
                <div class="empty-icon">ğŸ“¬</div>
                <p>æš‚æ— æ¶ˆæ¯</p>
            </div>
        </main>

        <!-- æ¶ˆæ¯è¯¦æƒ…æ¨¡æ€æ¡† -->
        <div id="messageModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modalTitle">æ¶ˆæ¯è¯¦æƒ…</h2>
                    <button class="modal-close" onclick="closeMessageModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="message-meta">
                        <span id="modalType" class="message-type"></span>
                        <span id="modalTime" class="message-time"></span>
                    </div>
                    <div id="modalContent" class="message-content"></div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeMessageModal()">å…³é—­</button>
                    <button id="modalDeleteBtn" class="btn btn-danger" onclick="deleteCurrentMessage()">åˆ é™¤</button>
                </div>
            </div>
        </div>

        <!-- é¡µè„š -->
        <footer>
            <p>&copy; 2025 æ–°é—»è®¢é˜…ç³»ç»Ÿ | Powered by NewsAPI</p>
        </footer>
    </div>

    <script src="/js/api.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/messages.js"></script>
    <script>
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = function() {
            if (!isLoggedIn()) {
                window.location.href = 'login.html';
                return;
            }
            loadMessages();
            updateMessageBadge();
        };
    </script>
</body>
</html>
